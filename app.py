import streamlit as st
import joblib
import numpy as np
from sklearn.datasets import load_breast_cancer

# 1. ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•
import os # ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á (‡∏õ‡∏Å‡∏ï‡∏¥‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß)

try:
    model = joblib.load('cancer_model.joblib')
except Exception as e:
    st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á: {e}") # ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏ö‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ Error ‡∏à‡∏£‡∏¥‡∏á‡πÜ
    
    # ‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏ß‡∏£‡πå‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏≤‡∏¢‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°?
    if not os.path.exists('cancer_model.joblib'):
        st.warning("‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏î‡πâ‡∏ß‡∏¢!")
        st.write(f"‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠: {os.getcwd()}")
        st.write("‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ:", os.listdir('.'))
    else:
        st.success("‡πÅ‡∏ï‡πà‡πÄ‡∏≠‡πä‡∏∞... ‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πá‡∏ß‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏ô‡∏∞ (‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô Library)")
        
    st.stop()


# 2. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤ "‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô" ‡∏°‡∏≤‡πÉ‡∏ä‡πâ (‡πÅ‡∏ó‡∏ô‡πÄ‡∏•‡∏Ç 0)
data = load_breast_cancer()
# ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á 30 ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏£‡∏∏‡∏Ç‡∏£‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà)
mean_values = np.mean(data.data, axis=0)

st.title("üè• AI ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏° (Final Version)")
st.write("‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ **‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ‡∏à‡∏£‡∏¥‡∏á** ‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏∏ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î")

# 3. ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
st.subheader("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")
col1, col2 = st.columns(2)
with col1:
    radius = st.slider("Mean Radius (‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠)", 5.0, 30.0, 15.0)
with col2:
    texture = st.slider("Mean Texture (‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß)", 10.0, 40.0, 20.0)

# 4. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ AI
# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ "‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô
input_data = mean_values.copy()

# ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Å‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏õ‡∏£‡∏±‡∏ö Slider
input_data[0] = radius   # ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤ Radius
input_data[1] = texture  # ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤ Texture

# ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Perimeter & Area)
# ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏Å‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡∏ç‡πà ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏¢‡∏≠‡∏∞)
input_data[2] = 2 * 3.14159 * radius        # Perimeter
input_data[3] = 3.14159 * (radius ** 2)     # Area

# ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Array 1 ‡πÅ‡∏ñ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á
final_input = np.array([input_data])

# 5. ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
if st.button("üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢"):
    prediction = model.predict(final_input)
    
    # 0 = Malignant (‡∏£‡πâ‡∏≤‡∏¢), 1 = Benign (‡∏î‡∏µ)
    if prediction[0] == 0:
        st.error(f"‡∏ú‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢: **Malignant (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏£‡πâ‡∏≤‡∏¢/‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á)** ‚ö†Ô∏è")
        st.write(f"‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î {radius} (‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡πâ‡∏ô‡∏£‡∏≠‡∏ö‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ï‡∏≤‡∏°‡∏Å‡∏±‡∏ô) ‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á")
    else:
        st.success(f"‡∏ú‡∏•‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢: **Benign (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏î‡∏µ/‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢)** ‚úÖ")
        st.write(f"‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß ‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥")
